DECL TOTAL;

SE EXECSQL('DEPENDENTES') = VERDADE E RESULTSQL('DEPENDENTES', 'TIPOPLANO') <> '0'
   ENTAO
        REPITA
            SE RESULTSQL('DEPENDENTES', 'TIPOPLANO') = '5' /* UNIMED ENFERMARIA RS*/
               ENTAO SALVAVALDEP(RESULTSQL('DEPENDENTES','NRODEPEND'),ABS(T('0003',(RESULTSQL('DEPENDENTES','IDADE') ))));
                     SETVAR(TOTAL,TOTAL + ABS(T('0003',(RESULTSQL('DEPENDENTES','IDADE') ))))
               SENAO 0 
            FIMSE
        ATE PROXREGSQL('DEPENDENTES') = FALSO
FIMSE;
TOTAL

SQL_DEPENDENTES

SELECT D.NRODEPEND, DATEDIFF(MONTH, D.DTNASCIMENTO,GETDATE()) /12 AS IDADE, C.TIPOPLANO, GRAUPARENTESCO
FROM PFDEPEND D, PFDEPENDCOMPL C
WHERE D.CODCOLIGADA = C.CODCOLIGADA
  AND D.CHAPA = C.CHAPA
  AND D.NRODEPEND = C.NRODEPEND
  AND D.CHAPA = :FRM_CHAPA
  AND D.INCASSISTMEDICA = 1
  AND D.CODCOLIGADA = :FRM_COLIGADA